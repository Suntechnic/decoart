{"version":3,"file":"script.js","sources":["../src/app-vue-components-formjob.js"],"sourcesContent":["import {Vue} from 'ui.vue';\n\nVue.component('app-vue-components-formjob', {\n\tprops: {\n\t\t'jobid': {}\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tuid: 'formjob',\n\t\t\tassets: {\n\t\t\t\timages: false,\n\t\t\t},\n\t\t\tstate: {\n\t\t\t\tsended: false,\n\t\t\t},\n\t\t\tdata: {\n\t\t\t\tphone: '',\n\t\t\t\tname: ''\n\t\t\t}\n\t\t}\n\t},\n\tcreated () {\n\t\tthis.assets.images = APP.config.assets.images;\n\t\tthis.uid = 'jobform_' + this.jobid + '_' + Math.floor(Math.random() * 999);\n \t},\n\tmethods: {\n\t\tshowMessage(title,text) {\n\t\t\tlet popup = new BX.PopupWindow(\"app-vue-components-form-message\", null, {\n\t\t\t\t\tcontent: '<h2>'+title+'</h2><p>'+text+'</p>',\n\t\t\t\t\tautoHide: true,\n\t\t\t\t\tcloseIcon: {right: \"20px\", top: \"10px\"},\n\t\t\t\t\tzIndex: 0,\n\t\t\t\t\toffsetLeft: 0,\n\t\t\t\t\toffsetTop: 0,\n\t\t\t\t\tdraggable: {restrict: false},\n\t\t\t\t\toverlay: {backgroundColor: 'black', opacity: '80' },\n\t\t\t\t\tevents: {\n\t\t\t\t\t\t\tonPopupClose: function () {\n\t\t\t\t\t\t\t\tthis.destroy();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t});\n\t\t\tpopup.show();\n\t\t},\n\t\tsend() {\n\t\t\tlet self = this;\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\tconst formData = new FormData(this.$refs.form);\n\t\t\tconst bxFormData = new BX.ajax.FormData();\n\t\t\t// данные из формы\n\t\t\tfor(let [name, value] of formData) {\n\t\t\t\tconsole.log(name, value);\n\t\t\t\tbxFormData.append(name, value);\n\t\t\t}\n\t\t\t// данные из модели\n\t\t\tfor(let name in this.data) {\n\t\t\t\tlet value = this.data['name'];\n\t\t\t\tconsole.log(name, value);\n\t\t\t\tbxFormData.append(name, value);\n\t\t\t}\n\t\t\t\n\t\t\tbxFormData.send(\n\t\t\t\t\t'/local/ajax.php',\n\t\t\t\t\t(data) => {\n\t\t\t\t\t\t\tif (data.status) {\n\t\t\t\t\t\t\t\tself.showMessage('Ошибка!','Попробуйте позже');\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tself.showMessage('Спасибо!','Наш менеджер свяжется с вами в ближайшее время');\n\t\t\t\t\t\t\t\tself.state.sended = true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t() => {},\n\t\t\t\t\t() => {self.showMessage('Ошибка!','Попробуйте позже')}\n\t\t\t\t);\n\t\t\t\n//\t\t\tBX.ajax({   \n//\t\t\t\t\turl: '/local/ajax.php',\n//\t\t\t\t\tdata: this.data,\n//\t\t\t\t\tmethod: 'POST',\n//\t\t\t\t\tdataType: 'json',\n//\t\t\t\t\ttimeout: 30,\n//\t\t\t\t\tasync: true,\n//\t\t\t\t\tprocessData: true,\n//\t\t\t\t\tscriptsRunFirst: true,\n//\t\t\t\t\temulateOnload: true,\n//\t\t\t\t\tstart: true,\n//\t\t\t\t\tcache: false,\n//\t\t\t\t\tonsuccess: function(data){\n//\t\t\t\t\t\tconsole.log(data)\n//\t\t\t\t\t\t\n//\t\t\t\t\t\tif (data.status) {\n//\t\t\t\t\t\t\tself.showMessage('Ошибка!','Попробуйте позже');\n//                        } else {\n//\t\t\t\t\t\t\tself.showMessage('Спасибо!','Наш менеджер свяжется с вами в ближайшее время');\n//\t\t\t\t\t\t\tself.state.sended = true\n//\t\t\t\t\t\t}\n//\t\t\t\t\t},\n//\t\t\t\t\tonfailure: function(){\n//\t\t\t\t\t\tself.showMessage('Ошибка!','Попробуйте позже');\n//\t\t\t\t\t}\n//\t\t\t\t})\n\t\t}\n\t},\n\tcomputed: {\n\t\tvalid() {\n\t\t\treturn !!(this.data.phone.replace(/[^\\d]/g, '').length==11 && this.data.name);\n\t\t}\n\t},\n\twatch: {\n\t\t'data.phone' (val,oval) {\n\t\t\t\n\t\t\tif (val.length > oval.length) {\n\t\t\t\n\t\t\t\tlet phone = val.replace(/[^\\d]/g, '').substring(0,11);\n\t\t\t\tlet lenPhone = phone.length;\n\t\t\t\tlet tt = phone.split('');\n\t\t\t\t\n\t\t\t\tif (lenPhone > 1) tt.splice(1,\"\", \"(\");\n\t\t\t\tif (lenPhone > 3) tt.splice(5,\"\", \")\");\n\t\t\t\tif (lenPhone > 5) tt.splice(9,\"\", \"-\");\n\t\t\t\tif (lenPhone > 7) tt.splice(12,\"\", \"-\");\n\t\t\t\t\n\t\t\t\tlet phone_formated = '+'+tt.join('');\n\t\t\t\t\n\t\t\t\tif (val != phone_formated) {\n\t\t\t\t\tthis.data.phone = phone_formated;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},template: `\n\t\t<div class=\"form__grid\">\n\t\t\t<div class=\"form__left\">\n\t\t\t\t<div class=\"form__title\">\n\t\t\t\t\t<p class=\"large\">понравилась вакансия —</p>\n\t\t\t\t\t<h2>отправь резюме</h2>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"form__right\"  v-if=\"!state.sended\">\n\t\t\t\t<div class=\"form__thank\">\n\t\t\t\t\t<div class=\"form__thank-image\"><img v-if=\"assets.images\" v-bind:src=\"assets.images+'/deco-part.png'\" alt=\"\"></div>\n\t\t\t\t\t<div class=\"form__thank-info\">\n\t\t\t\t\t\t<p class=\"large\">благодарим</p>\n\t\t\t\t\t\t<p>ваша заявка принята</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"form__thank-close\"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"form__container\">\n\t\t\t\t\t<form action=\"#\" ref=\"form\">\n\t\t\t\t\t\t<input type=\"hidden\" name=\"jobid\" v-bind:value=\"jobid\">\n\t\t\t\t\t\t<div class=\"input-container\">\n\t\t\t\t\t\t\t<input type=\"text\"  v-model=\"data.name\" placeholder=\"Ваше имя\">\n\t\t\t\t\t\t\t<div class=\"label\">Ваше имя</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"input-container\">\n\t\t\t\t\t\t\t<input type=\"text\" v-model=\"data.phone\" placeholder=\"телефон\">\n\t\t\t\t\t\t\t<div class=\"label\">телефон</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"input-container\">\n\t\t\t\t\t\t\t<input name=\"file\" type=\"file\" v-bind:id=\"uid+'_file'\" class=\"field field__file\" multiple=\"\">\n\t\t\t\t\t\t\t<label class=\"field__file-wrapper\" v-bind:for=\"uid+'_file'\">\n\t\t\t\t\t\t\t\t<div class=\"field__file-fake\">прикрепить файл</div>\n\t\t\t\t\t\t\t\t<div class=\"field__file-button\">...</div>\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<button class=\"btn btn--border\" v-on:click.prevent=\"send\" v-bind:disabled=\"!valid\">Оправить</button>\n\t\t\t\t\t\t<p>Нажимая кнопку Отправить, я даю <a href=\"/legal/\">согласие на Обработку персональных данных</a></p>\n\t\t\t\t\t</form>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`\n});\n"],"names":["Vue","component","props","data","uid","assets","images","state","sended","phone","name","created","APP","config","jobid","Math","floor","random","methods","showMessage","title","text","popup","BX","PopupWindow","content","autoHide","closeIcon","right","top","zIndex","offsetLeft","offsetTop","draggable","restrict","overlay","backgroundColor","opacity","events","onPopupClose","destroy","show","send","self","formData","FormData","$refs","form","bxFormData","ajax","value","console","log","append","status","computed","valid","replace","length","watch","val","oval","substring","lenPhone","tt","split","splice","phone_formated","join","template"],"mappings":"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"}